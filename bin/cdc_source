use dataassetpro;

set table.exec.sink.upsert-materialize=None;

EXECUTE CDCSOURCE paimon_demo WITH (
  'connector' = 'mysql-cdc',
  ${bigdata-polardb}
  'checkpoint' = '30000',
  'scan.startup.mode' = 'latest-offset',
  'parallelism' = '1',
  'table-name' = 'dataassetpro\..*',
  'sink.connector' = 'paimon',
  'sink.path' = 'oss://qm-bigdata-hdfs.cn-shanghai.oss-dls.aliyuncs.com/user/paimon/warehouse/#{schemaName}.db/#{tableName}',
  'sink.auto-create' = 'true',
  'sink.table.properties.full-compaction.delta-commits' = '5'
);

create catalog hive_catalog with(
    'type' = 'paimon',
    'metastore' = 'hive',
    'uri' = 'thrift://cdhpro001:9083',
    'warehouse' = 'oss://qm-bigdata-hdfs.cn-shanghai.oss-dls.aliyuncs.com/user/paimon/warehouse/'
);

use catalog hive_catalog;